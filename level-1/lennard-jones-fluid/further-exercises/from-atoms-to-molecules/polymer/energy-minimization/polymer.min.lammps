# PART A - ENERGY MINIMIZATION

# 1) Initialization
units lj
dimension 3
atom_style molecular
bond_style harmonic
angle_style harmonic
pair_style lj/cut 2.5
boundary p p p

# 2) System definition
# Cubic Box
region simulation_box block -20 20 -20 20 -20 20

# Small Elongated Box
# region simulation_box block -20 20 -6 6 -6 6

create_box 2 simulation_box bond/types 1 angle/types 1 extra/bond/per/atom 1 extra/angle/per/atom 2 extra/special/per/atom 5

# Import and use molecule template to populate box with molecules
molecule polymer ../polymer.mol
create_atoms 1 random 1500 341341 simulation_box

# Create a single polymer
# create_atoms 0 single 0 0 0 mol polymer 14356

# Create several polymers
create_atoms 0 random 5 678865 simulation_box mol polymer 8751

# 3) Simulation settings
mass 1 1
mass 2 1
pair_coeff 1 1 1.0 1.0
pair_coeff 2 2 0.5 3.0
bond_coeff 1 5 2.5
angle_coeff 1 2 180

# 4) Visualization
thermo 10
thermo_style custom step temp pe ke etotal press
dump dump_all_atoms_per_100_timestep all atom 10 dump_all_atoms_per_100_timestep.min.lammpstrj

# 5) Run
minimize 1.0e-4 1.0e-6 1000 10000
write_data minimized_coordinate.data pair ij