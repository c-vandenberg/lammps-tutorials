log ../logs/improved-input-md-log.lammps
# PART B - MOLECULAR DYNAMICS

# 1) Initialization
units lj
dimension 3
atom_style atomic
pair_style lj/cut 2.5
boundary p p p

# 2) System definition
read_data ../../improved-min-input/data/raw/topology/minimized_coordinate.data

region region_inside_cylinder cylinder z 0 0 10 INF INF side in
region region_outside_cylinder cylinder z 0 0 10 INF INF side out

group group_atom_type_1 type 1
group group_atom_type_2 type 2

group group_region_inside_cylinder region region_inside_cylinder
group group_region_outside_cylinder region region_outside_cylinder

group group_atom_type_1_inside_cylinder intersect group_atom_type_1 group_region_inside_cylinder
group group_atom_type_2_outside_cylinder intersect group_atom_type_2 group_region_outside_cylinder

delete_atoms group group_atom_type_1_inside_cylinder
delete_atoms group group_atom_type_2_outside_cylinder

# 3) Visualization
thermo 1000
dump dump_all_atoms_per_100_timestep all atom 1000 ../data/raw/trajectory/dump_all_atoms_per_100_timestep.md.lammpstrj

variable number_atom_type_1_inside_cylinder equal count(group_atom_type_1,region_inside_cylinder)
variable number_atom_type_2_inside_cylinder equal count(group_atom_type_2,region_inside_cylinder)

fix fix_count_atom_type_1_inside_cylinder all ave/time 10 200 2000 v_number_atom_type_1_inside_cylinder &
    file ../data/raw/atom-population/output_atom_type_1_population_inside_cylinder_vs_time.dat
fix fix_count_atom_type_2_inside_cylinder all ave/time 10 200 2000 v_number_atom_type_2_inside_cylinder &
    file ../data/raw/atom-population/output_atom_type_2_population_inside_cylinder_vs_time.dat

compute compute_atom_type_1_coordination_number group_atom_type_1 coord/atom cutoff 2.0 group group_atom_type_2
compute compute_average_atom_type_1_coordination_number all reduce ave c_compute_atom_type_1_coordination_number

fix fix_average_atom_type_1_coordination_number all ave/time 10 200 2000 &
    c_compute_average_atom_type_1_coordination_number &
    file ../data/raw/atom-coordination-number/output_average_atom_type_1_coordination_number.dat

# 4) Run
velocity all create 1.0 4928459 mom yes rot yes dist gaussian
fix fix_nve_ensemble all nve
fix fix_langevin_thermostat all langevin 1.0 1.0 0.1 1530917 zero yes
timestep 0.005
run 300000
write_data ../data/raw/topology/atom_type_1_atom_type_2_mixing.data
